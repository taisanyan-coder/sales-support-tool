【要件定義書 v2.0】営業支援ツール（企業別メモ管理）MVP
前提：Google Apps Script（GAS）＋ Googleスプレッドシート
利用者：単独ユーザー（個人専用）
認証：なし（URLを知っている人のみアクセス）
タイムゾーン：Asia/Tokyo 固定
日付判定基準：GASサーバー基準

==================================================
1. 目的
==================================================
企業ごとのアクション（メモ＋TODO）を一元管理し、
履歴を蓄積しながら期限管理を確実に行う。

==================================================
2. スコープ
==================================================
・新規スプレッドシートを手動作成し、そのIDをGASに設定する
・Companies（企業マスタ）とActions（アクション管理）の2シート構成
・Web画面でActionsの追加・編集・状態変更・論理削除を完結
・CompaniesはWebで編集しない（シート直管理）

==================================================
3. 非スコープ（やらないこと）
==================================================
・企業別シート作成
・通知（メール・リマインド）
・ダッシュボード／グラフ
・インポート／エクスポート
・自動アーカイブ
・マルチユーザー管理
・添付ファイル管理
・企業マスタのWeb編集
・論理削除データの復元機能
・外部スタッフDBへの書き込み

==================================================
4. データ構造
==================================================

【Companiesシート】

列（列名固定）
- company_id
- company_name（必須・ユニーク）
- contact_contract_billing（複数行テキスト：名前＋メール）
- contact_sales_trouble（複数行テキスト：名前＋メール）
- memo_company（任意）

【Actionsシート】

列（列名固定・順不同対応）
- action_id
- created_at（自動）
- updated_at（自動）
- due_date（必須・日付のみ）
- company_name（Companies参照プルダウン）
- staff_name（任意／候補表示＋自由入力可）
- category（固定3種）
    ・契約・請求
    ・営業・トラブル
    ・その他
- status（固定3種）
    ・未対応（初期値固定）
    ・対応中
    ・完了
- note（必須）
- completed_at（完了時自動セット／未完了に戻すとクリア）
- is_deleted（論理削除フラグ）
- deleted_at（論理削除日時）

※列不足・列名不一致はエラーで停止（自動修正しない）

==================================================
5. 外部参照（スタッフ候補）
==================================================
参照スプレッドシートID：
1X0sdAY32MFk98mwqwPMFOpdI5-2KSfjSU71NBDOoyUo

参照シート名：
「決定」

参照列：
E列＝企業名
C列＝スタッフ名

仕様：
・company_name選択時に外部DB参照
・一致企業のスタッフ名を重複除外して候補表示
・staff_nameは自由入力も可
・空欄も許容
・参照失敗時もエラーにせず候補なしで続行

==================================================
6. UI仕様
==================================================

■ 画面構成
・上部：新規登録フォーム（常設）
・下部：一覧テーブル

■ 新規フォーム項目順
1. 企業名
2. スタッフ名
3. カテゴリ
4. 期限日（必須）
5. 状態（初期値＝未対応）
6. メモ

登録成功後：全項目クリア

■ 一覧表示
表示列：
・企業名
・スタッフ名
・期限日
・状態
・カテゴリ
・メモ（省略表示）

並び順：
1. due_date 昇順
2. created_at 昇順

ページング：なし（全件表示）

■ メモ表示
・一覧では省略表示
・クリックでモーダル表示
・モーダル内で編集可能

■ 視覚ルール
・期限切れ（due_date < 今日 且つ 未完了） → 赤文字
・今日期限（due_date = 今日 且つ 未完了） → 別色強調（例：オレンジ）
・完了 → 薄く表示
・論理削除データ → UIに表示しない

■ 窓口表示
・category＝契約・請求 → 契約・請求窓口表示
・category＝営業・トラブル → 営業・トラブル窓口表示
・category＝その他 → 両方表示
・参照表示のみ（編集不可）

==================================================
7. 削除仕様
==================================================
・UI削除は論理削除のみ
・is_deleted=true設定
・deleted_at記録
・物理削除しない
・復元機能なし

==================================================
8. 受入条件
==================================================
・上記仕様通りに動作する
・期限必須チェックが動作
・外部スタッフ参照が動作
・視覚ルールが適用される
・削除は論理削除のみ
・列名不一致でエラー停止する